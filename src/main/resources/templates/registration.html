<!DOCTYPE html>
<html th:lang="${GLOBAL_CONSTANTS_MAP.get('LANG')}" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/shared/head.html :: head(title = 'Registration')}">
</head>

<body>

<div>
   <a th:href="@{/}">Home</a>
   <a th:href="@{/login}">Login</a>
</div>
<h1>Registrazione nuovo utente</h1>
<form id="registration-form" method="POST" name="registration-form"
      th:action="@{/registerNewUser}">
   <div
         th:replace="~{fragments/shared/message/error/errorMessage.html :: errorMessage(text = ${userNotRegisteredError}, condition = ${userNotRegisteredError != null})}"></div>
   <div>
      <label for="name">Nome:</label>
      <input id="name" name="name" placeholder="Insert your name" required th:field="${user.name}"
             th:maxlength="${FIELD_SIZES_MAP.get('NAME_MAX_LENGTH')}"
             th:minlength="${FIELD_SIZES_MAP.get('NAME_MIN_LENGTH')}" th:object="${user}" type="text"/>
      <div
            th:replace="~{fragments/shared/message/error/fieldErrorMessage.html :: fieldErrorMessage(field = 'user.name')}"></div>
      <br><br>
   </div>
   <div>
      <label for="surname">Surname:</label>
      <input id="surname" name="surname"
             placeholder="Insert your surname" required th:field="${user.surname}"
             th:maxlength="${FIELD_SIZES_MAP.get('SURNAME_MAX_LENGTH')}"
             th:minlength="${FIELD_SIZES_MAP.get('SURNAME_MIN_LENGTH')}" th:object="${user}" type="text"/>
      <div
            th:replace="~{fragments/shared/message/error/fieldErrorMessage.html :: fieldErrorMessage(field = 'user.surname')}"></div>
      <br><br>
   </div>
   
   <div>
      <label for="birth-date">Date of birth:</label>
      <input id="birth-date" name="birth-date"
             required th:field="${user.birthDate}" th:fieldFormat="${TEMPORALS_MAP.get('DATE_FORMAT')}"
             th:format="${TEMPORALS_MAP.get('DATE_FORMAT')}"
             th:max="${TEMPORALS_MAP.get('BIRTHDATE_MAX_VALUE')}" th:min="${TEMPORALS_MAP.get('BIRTHDATE_MIN_VALUE')}"
             th:object="${user}" type="date"/>
      <div
            th:replace="~{fragments/shared/message/error/fieldErrorMessage.html :: fieldErrorMessage(field = 'user.birthDate')}"></div>
      <br><br>
   </div>
   
   <div>
      <label for="balance">Balance ($):</label>
      <input id="balance" name="balance" placeholder="Insert your balance ($)" required step="0.1"
             th:field="${user.balance}" th:max="${FIELD_SIZES_MAP.get('BALANCE_MAX_VALUE')}"
             th:min="${FIELD_SIZES_MAP.get('BALANCE_MIN_VALUE')}" th:object="${user}" type="number"/>
      <div
            th:replace="~{fragments/shared/message/error/fieldErrorMessage.html :: fieldErrorMessage(field = 'user.balance')}"></div>
      <br><br>
   </div>
   
   <div>
      <label for="email">Email:</label>
      <input id="email" name="email"
             placeholder="Insert your email" required th:field="${user.email}"
             th:maxlength="${FIELD_SIZES_MAP.get('EMAIL_MAX_LENGTH')}"
             th:minlength="${FIELD_SIZES_MAP.get('EMAIL_MIN_LENGTH')}" th:object="${user}" type="email"/>
      <div
            th:replace="~{fragments/shared/message/error/fieldErrorMessage.html :: fieldErrorMessage(field = 'user.email')}"></div>
      <div
            th:replace="~{fragments/shared/message/error/errorMessage.html :: errorMessage(text = ${emailUniqueError}, condition = ${emailUniqueError != null})}"></div>
      <br><br>
   </div>
   
   <div>
      <label for="username">Username:</label>
      <input id="username" name="username"
             placeholder="Insert your username" required th:field="${credentials.username}"
             th:maxlength="${FIELD_SIZES_MAP.get('USERNAME_MAX_LENGTH')}"
             th:minlength="${FIELD_SIZES_MAP.get('USERNAME_MIN_LENGTH')}"
             th:object="${credentials}" type="text">
      <div
            th:replace="~{fragments/shared/message/error/fieldErrorMessage.html :: fieldErrorMessage(field = 'credentials.username')}"></div>
      <div
            th:replace="~{fragments/shared/message/error/errorMessage.html :: errorMessage(text = ${usernameUniqueError}, condition = ${usernameUniqueError != null})}"></div>
      <br><br>
   </div>
   
   <div class="input-group">
      <label for="password">Password:</label>
      <input id="password" name="password"
             placeholder="Insert your password" required th:field="${credentials.password}"
             th:maxlength="${FIELD_SIZES_MAP.get('PASSWORD_MAX_LENGTH')}"
             th:minlength="${FIELD_SIZES_MAP.get('PASSWORD_MIN_LENGTH')}" th:object="${credentials}" type="password"/>
      <button class="btn btn-outline-secondary" id="toggle-password-visibility" type="button">
         <!-- Icona dell'occhio per mostrare/nascondere la password -->
         <i class="fas fa-eye" id="eye-icon"></i>
      </button>
   </div>
   <div
         th:replace="~{fragments/shared/message/error/fieldErrorMessage.html :: fieldErrorMessage(field = 'credentials.password')}"></div>
   <div>
      <div
            th:replace="~{fragments/shared/message/error/errorMessage.html :: errorMessage(text = ${passwordFormatError}, condition = ${passwordFormatError != null})}"></div>
      <br>
      <label for="confirm-password">Confirm Password:</label>
      <input id="confirm-password" name="confirm-password"
             placeholder="Confirm your password" required
             th:maxlength="${FIELD_SIZES_MAP.get('PASSWORD_MAX_LENGTH')}"
             th:minlength="${FIELD_SIZES_MAP.get('PASSWORD_MIN_LENGTH')}" type="password"/>
      <div
            th:replace="~{fragments/shared/message/error/errorMessage.html :: errorMessage(text = ${passwordDifferentFromConfirmPasswordError}, condition = ${passwordDifferentFromConfirmPasswordError != null})}"></div>
      <br><br>
   </div>
   
   <div>
      <label for="nation">Nation:</label>
      <select id="nation" name="nation" required th:field="${user.nation}" th:object="${user}">
         <option th:each="nation : ${nations}" th:field="${user.nation}" th:id="${nation.name + '#' + nation.id}"
                 th:name="${nation.name + '#' + nation.id}"
                 th:text="${nation.name}" th:value="${nation.id}"></option>
      </select>
      <div
            th:replace="~{fragments/shared/message/error/errorMessage.html :: errorMessage(text = ${nationNotExistsError}, condition = ${nationNotExistsError != null})}"></div>
      <br><br>
   </div>
   <div
         th:replace="~{fragments/shared/message/error/fieldErrorMessage.html :: fieldErrorMessage(field = 'user.nation')}"></div>
   <div>
      <input form="registration-form" formmethod="POST" id="submit" name="submit" type="submit" value="Register"/>
   </div>
</form>
<script th:charset="${GLOBAL_CONSTANTS_MAP.get('CHARSET')}" th:src="@{/js/shared/maxDateInputValue.js}"
        type="text/javascript"></script>
<script th:charset="${GLOBAL_CONSTANTS_MAP.get('CHARSET')}" th:src="@{/js/shared/showPassword.js}"
        type="text/javascript"></script>
<script th:charset="${GLOBAL_CONSTANTS_MAP.get('CHARSET')}" th:src="@{/js/registration/index.js}"
        type="text/javascript"></script>
</body>

</html>